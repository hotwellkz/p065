# Отчёт: Исправление выхода правой группы (уведомления + профиль) за границы шапки

## Проблема

На странице `/channels` верхняя панель имела проблему: блок справа (иконка уведомлений + профиль/дропдаун) выезжал за границы контейнера/шапки и визуально "висел" справа вне блока.

## Причина проблемы

**Основная причина**: Неправильная структура flex-контейнера:
1. Правая часть имела `flex-shrink-0` и `w-full lg:w-auto`, что на широких экранах могло приводить к выходу за границы
2. NotificationBell и UserMenu находились внутри одного контейнера с кнопками, без четкого разделения на группы
3. Отсутствовал правильный `flex-wrap` с ограничениями для правой группы

## Решение

### 1. Разделена структура на leftGroup и rightGroup

**Файл**: `src/pages/ChannelList/ChannelListPage.tsx` (строки 607-828)

**Изменения**:

#### A) Родительский контейнер
```tsx
<div className="flex items-start justify-between gap-3 lg:gap-6 flex-wrap">
```
- Убран `lg:flex-nowrap` - теперь всегда разрешен перенос
- Gap уменьшен до `gap-3` для лучшего контроля

#### B) Правая часть разделена на группы
```tsx
<div className="flex items-center gap-2 flex-wrap flex-1 lg:flex-0 lg:flex-initial min-w-0 lg:min-w-[520px] justify-end">
  {/* leftGroup: основные кнопки */}
  <div className="flex items-center gap-1.5 flex-wrap flex-1 lg:flex-0 lg:flex-initial min-w-0 justify-end max-w-full">
    {/* Кнопки */}
  </div>
  {/* Переключатель раскладки */}
  {/* rightGroup: уведомления и профиль */}
  <div className="flex items-center gap-2 flex-shrink-0 w-full lg:w-auto justify-end lg:justify-start">
    <NotificationBell />
    <UserMenu />
  </div>
</div>
```

**Логика адаптива**:
- **На широких экранах (lg+)**: 
  - Правая часть имеет `flex-0 flex-initial` и `min-w-[520px]` - фиксированная ширина
  - leftGroup и rightGroup в одной строке
  - rightGroup имеет `w-auto` - занимает только необходимое место
  
- **На узких экранах (<lg)**:
  - Правая часть имеет `flex-1` - может расширяться
  - rightGroup имеет `w-full` - занимает всю ширину
  - rightGroup переходит на новую строку благодаря `flex-wrap`
  - `justify-end` выравнивает rightGroup вправо на второй строке

### 2. Ограничения для предотвращения выхода за границы

- **leftGroup**: `max-w-full` - не может выйти за границы родителя
- **rightGroup**: `flex-shrink-0` - не сжимается, но `w-full lg:w-auto` контролирует ширину
- **Родительский контейнер**: `flex-wrap` - разрешает перенос на новую строку

### 3. Проверка dropdown профиля

- UserMenu использует `createPortal` для рендеринга dropdown вне DOM-иерархии
- Dropdown позиционируется через `fixed` с вычислением позиции относительно viewport
- Header не имеет `overflow: hidden`, поэтому dropdown не обрезается

## Изменённые файлы

1. **src/pages/ChannelList/ChannelListPage.tsx**
   - Обновлена структура правой части header (строки 607-828)
   - Разделена на leftGroup и rightGroup
   - Добавлены правильные flex-ограничения и адаптивные классы

## Команды PowerShell

```powershell
# Установка зависимостей (если нужно)
npm install

# Запуск в режиме разработки
npm run dev

# Сборка для production
npm run build
```

## Чеклист проверки

### ✅ Desktop (1920px, 1366px)
- [ ] Всё в одну строку, внутри контейнера
- [ ] NotificationBell и UserMenu справа, не выходят за границы
- [ ] Dropdown профиля открывается корректно, не обрезается
- [ ] Никаких горизонтальных скроллов

### ✅ Tablet (1024px)
- [ ] Возможно 2 строки (если не хватает места)
- [ ] rightGroup (уведомления + профиль) на второй строке, выровнены вправо
- [ ] Всё внутри блока шапки, ничего не вылезает
- [ ] Dropdown профиля работает корректно

### ✅ Mobile (768px, 430px, 390px)
- [ ] 2 строки стабильно
- [ ] rightGroup на второй строке, занимает всю ширину, выровнен вправо
- [ ] Колокольчик и профиль визуально внутри голубого блока шапки
- [ ] Никаких overflow наружу
- [ ] Dropdown профиля не обрезается

## Технические детали

### Логика адаптива

1. **Родительский контейнер**:
   - `flex-wrap` - разрешает перенос элементов
   - `justify-between` - распределяет пространство между группами
   - `gap-3 lg:gap-6` - адаптивные отступы

2. **Правая часть**:
   - `flex-1 lg:flex-0 lg:flex-initial` - на узких расширяется, на широких фиксированная
   - `min-w-0 lg:min-w-[520px]` - минимальная ширина для широких экранов
   - `justify-end` - выравнивание вправо

3. **leftGroup (кнопки)**:
   - `flex-1 lg:flex-0 lg:flex-initial` - адаптивная ширина
   - `max-w-full` - не выходит за границы
   - `flex-wrap` - разрешает перенос кнопок при нехватке места

4. **rightGroup (уведомления + профиль)**:
   - `w-full lg:w-auto` - на узких занимает всю ширину, на широких только необходимое
   - `justify-end lg:justify-start` - выравнивание вправо на узких, влево на широких
   - `flex-shrink-0` - не сжимается

### Почему dropdown не обрезается

- UserMenu использует `createPortal` для рендеринга dropdown в `document.body`
- Dropdown позиционируется через `fixed` с вычислением позиции относительно viewport
- Header не имеет `overflow: hidden`, поэтому dropdown не обрезается родительским контейнером

## Результат

✅ Правая группа (уведомления + профиль) всегда внутри блока шапки
✅ На узких экранах rightGroup переходит на новую строку и выравнивается вправо
✅ Никаких горизонтальных скроллов и overflow наружу
✅ Dropdown профиля не обрезается
✅ Адаптивность работает на всех breakpoints (1920px, 1366px, 1024px, 768px, 430px, 390px)

