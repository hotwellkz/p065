# üöÄ –§–∏–Ω–∞–ª—å–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –¥–µ–ø–ª–æ—é

## ‚úÖ –ß—Ç–æ —É–∂–µ –≥–æ—Ç–æ–≤–æ:

1. ‚úÖ –í—Å–µ —Å–∫—Ä–∏–ø—Ç—ã –¥–µ–ø–ª–æ—è —Å–æ–∑–¥–∞–Ω—ã –∏ –∑–∞–∫–æ–º–º–∏—á–µ–Ω—ã –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
2. ‚úÖ Backend –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏–µ `0.0.0.0:8080`
3. ‚úÖ `BACKEND_URL` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –Ω–∞ `http://185.104.248.130:5001`
4. ‚úÖ –ú–µ–¥–∏–∞-—Ä–æ—É—Ç—ã –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç Range-–∑–∞–ø—Ä–æ—Å—ã
5. ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞

## üìã –®–∞–≥–∏ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–µ–ø–ª–æ—è:

### –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

```bash
cd backend
bash check_deploy_ready.sh
```

### –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ VPS (–µ—Å–ª–∏ –µ—â—ë –Ω–µ —Å–¥–µ–ª–∞–Ω–æ)

**–ù–∞ –≤–∞—à–µ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ:**
```bash
# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–∫—Ä–∏–ø—Ç –Ω–∞ VPS
scp backend/vps/synology-port-forward.sh root@185.104.248.130:/root/
```

**–ù–∞ VPS:**
```bash
ssh root@185.104.248.130
chmod +x synology-port-forward.sh
sudo ./synology-port-forward.sh
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```bash
# –ù–∞ VPS
curl -I http://127.0.0.1:5001/health
```

### –®–∞–≥ 3: –î–µ–ø–ª–æ–π –Ω–∞ Synology

**–í–∞—Ä–∏–∞–Ω—Ç A: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π —Å –≤–∞—à–µ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞**

```bash
cd backend
export SYNO_HOST="hotwell.synology.me"  # –∏–ª–∏ IP –∞–¥—Ä–µ—Å Synology
export SYNO_USER="admin"                 # –≤–∞—à –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
chmod +x deploy_synology_auto.sh
./deploy_synology_auto.sh
```

–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- –ü–æ–¥–∫–ª—é—á–∏—Ç—Å—è –∫ Synology –ø–æ SSH
- –°–∫–æ–ø–∏—Ä—É–µ—Ç –∫–æ–¥ –∏–∑ GitHub
- –£—Å—Ç–∞–Ω–æ–≤–∏—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- –°–∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç TypeScript
- –ù–∞—Å—Ç—Ä–æ–∏—Ç .env
- –ó–∞–ø—É—Å—Ç–∏—Ç —á–µ—Ä–µ–∑ pm2
- –ù–∞—Å—Ç—Ä–æ–∏—Ç –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫

**–í–∞—Ä–∏–∞–Ω—Ç B: –î–µ–ø–ª–æ–π –ø—Ä—è–º–æ –Ω–∞ Synology**

```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ Synology
ssh admin@hotwell.synology.me

# –í—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—ã
cd /volume1/shortsai
git clone https://github.com/hotwellkz/p041.git app
cd app/backend
chmod +x deploy_to_synology_production.sh
sudo ./deploy_to_synology_production.sh
```

### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

**–ù–∞ Synology:**
```bash
# –õ–æ–∫–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
curl http://127.0.0.1:8080/health

# –ü—Ä–æ–≤–µ—Ä–∫–∞ pm2
pm2 status
pm2 logs shortsai-backend
```

**–ß–µ—Ä–µ–∑ VPS (–ø—É–±–ª–∏—á–Ω—ã–π –¥–æ—Å—Ç—É–ø):**
```bash
# –° –ª—é–±–æ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ
curl http://185.104.248.130:5001/health

# –î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å: {"ok":true}
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –º–µ–¥–∏–∞-—Ä–æ—É—Ç–∞:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ Range-–∑–∞–ø—Ä–æ—Å–æ–≤ (–¥–ª—è Blotato)
curl -I -H "Range: bytes=0-1023" http://185.104.248.130:5001/api/media/test/test/test.mp4
# –î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å: 206 Partial Content
```

## üîß –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è:

```bash
# –°—Ç–∞—Ç—É—Å
pm2 status

# –õ–æ–≥–∏
pm2 logs shortsai-backend

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
pm2 restart shortsai-backend

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
pm2 stop shortsai-backend

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
pm2 monit
```

## üìù –í–∞–∂–Ω—ã–µ —Ñ–∞–π–ª—ã:

- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π**: `backend/deploy_synology_auto.sh`
- **–î–µ–ø–ª–æ–π –Ω–∞ Synology**: `backend/deploy_to_synology_production.sh`
- **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ VPS**: `backend/vps/synology-port-forward.sh`
- **–ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏**: `backend/check_deploy_ready.sh`
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: `backend/DEPLOY_PRODUCTION.md`

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:

–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –ø—Ä–æ–≤–µ—Ä—å—Ç–µ `.env` –Ω–∞ Synology:

```bash
cat /volume1/shortsai/app/backend/.env | grep BACKEND_URL
# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: BACKEND_URL=http://185.104.248.130:5001
```

## üêõ –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫:

### Backend –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å pm2:
   ```bash
   pm2 status
   ```

2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:
   ```bash
   pm2 logs shortsai-backend --lines 50
   ```

3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—Ä—Ç:
   ```bash
   netstat -tuln | grep 8080
   ```

### –ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ VPS:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ VPN —Ç—É–Ω–Ω–µ–ª—å:
   ```bash
   # –ù–∞ VPS
   ping 10.8.0.2
   ```

2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª–∞ iptables:
   ```bash
   # –ù–∞ VPS
   sudo iptables -t nat -L PREROUTING -n -v
   ```

3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ firewall –Ω–∞ Synology:
   - Control Panel ‚Üí Security ‚Üí Firewall
   - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–æ—Ä—Ç 8080 —Ä–∞–∑—Ä–µ—à—ë–Ω –¥–ª—è VPN —Å–µ—Ç–∏

### Blotato –Ω–µ –º–æ–∂–µ—Ç –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `BACKEND_URL`:
   ```bash
   # –ù–∞ Synology
   grep BACKEND_URL /volume1/shortsai/app/backend/.env
   ```

2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞:
   ```bash
   curl -I http://185.104.248.130:5001/health
   ```

3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Blotato:
   ```bash
   pm2 logs shortsai-backend | grep "BlottataLocalFileProcessor"
   ```

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:

- **–ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è**: `backend/DEPLOY_PRODUCTION.md`
- **–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç**: `backend/QUICK_START_PRODUCTION.md`
- **–ö–æ—Ä–Ω–µ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è**: `DEPLOY_NOW.md`

---

**–ì–æ—Ç–æ–≤–æ –∫ –¥–µ–ø–ª–æ—é!** üéâ

–í—Å–µ —Ñ–∞–π–ª—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏: https://github.com/hotwellkz/p041


