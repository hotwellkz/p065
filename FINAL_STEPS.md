# –§–∏–Ω–∞–ª—å–Ω—ã–µ —à–∞–≥–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

## ‚úÖ –ß—Ç–æ —É–∂–µ —Å–¥–µ–ª–∞–Ω–æ:

1. ‚úÖ Nginx —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω
2. ‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞ –∏ –ø—Ä–æ–≤–µ—Ä–µ–Ω–∞ (nginx -t —É—Å–ø–µ—à–Ω–æ)
3. ‚úÖ Nginx –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
4. ‚úÖ Firewall –Ω–∞—Å—Ç—Ä–æ–µ–Ω (–ø–æ—Ä—Ç—ã 80/443 –æ—Ç–∫—Ä—ã—Ç—ã)
5. ‚úÖ Backend –¥–æ—Å—Ç—É–ø–µ–Ω —á–µ—Ä–µ–∑ VPN (10.8.0.2:5000)
6. ‚úÖ –õ–æ–∫–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ Nginx —Ä–∞–±–æ—Ç–∞–µ—Ç (200 OK —Å CORS –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏)

## üìã –ß—Ç–æ –æ—Å—Ç–∞–ª–æ—Å—å —Å–¥–µ–ª–∞—Ç—å:

### –®–∞–≥ 1: –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ VPS

```powershell
ssh root@159.255.37.158
```

### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ Nginx
systemctl status nginx

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã –ª–æ–∫–∞–ª—å–Ω–æ
curl -I http://127.0.0.1/

# –ü—Ä–æ–≤–µ—Ä–∫–∞ backend —á–µ—Ä–µ–∑ VPN
curl -I http://10.8.0.2:5000/
```

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ DNS

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ dnsutils –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
apt install -y dnsutils

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ DNS
dig +short api.hotwell.synology.me

# –î–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å: 159.255.37.158
```

**–ï—Å–ª–∏ DNS –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω:**
- –°–æ–∑–¥–∞–π—Ç–µ A-–∑–∞–ø–∏—Å—å: `api.hotwell.synology.me` ‚Üí `159.255.37.158`
- –ü–æ–¥–æ–∂–¥–∏—Ç–µ 5-10 –º–∏–Ω—É—Ç –¥–ª—è —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è

### –®–∞–≥ 4: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Certbot

```bash
apt install -y certbot python3-certbot-nginx
```

### –®–∞–≥ 5: –ü–æ–ª—É—á–∏—Ç–µ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç

**–í–ê–ñ–ù–û:** DNS –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω –î–û –ø–æ–ª—É—á–µ–Ω–∏—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞!

```bash
# –ó–∞–º–µ–Ω–∏—Ç–µ YOUR_EMAIL@example.com –Ω–∞ –≤–∞—à —Ä–µ–∞–ª—å–Ω—ã–π email
certbot --nginx -d api.hotwell.synology.me \
  --non-interactive \
  --agree-tos \
  -m YOUR_EMAIL@example.com
```

Certbot –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- –ü–æ–ª—É—á–∏—Ç SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –æ—Ç Let's Encrypt
- –û–±–Ω–æ–≤–∏—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é Nginx (–¥–æ–±–∞–≤–∏—Ç HTTPS –±–ª–æ–∫)
- –ù–∞—Å—Ç—Ä–æ–∏—Ç —Ä–µ–¥–∏—Ä–µ–∫—Ç —Å HTTP –Ω–∞ HTTPS
- –ù–∞—Å—Ç—Ä–æ–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞

### –®–∞–≥ 6: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ HTTPS
curl -I https://api.hotwell.synology.me/

# –î–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å: HTTP/2 200

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å VPS
curl -v https://api.hotwell.synology.me/ 2>&1 | head -20
```

### –®–∞–≥ 7: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å –≤–Ω–µ—à–Ω–µ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (4G)

–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–µ:
- `https://api.hotwell.synology.me/`

–î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å—Å—è —Å—Ç–∞—Ç—É—Å 200.

### –®–∞–≥ 8: –ü—Ä–æ–≤–µ—Ä–∫–∞ Range –∑–∞–ø—Ä–æ—Å–æ–≤ (–¥–ª—è –≤–∏–¥–µ–æ)

```bash
# –ó–∞–º–µ–Ω–∏—Ç–µ –ø—É—Ç—å –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π –ø—É—Ç—å –∫ –≤–∏–¥–µ–æ —Ñ–∞–π–ª—É
curl -r 0-1023 -I https://api.hotwell.synology.me/api/media/user/channel/file.mp4

# –î–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å:
# HTTP/1.1 206 Partial Content
# Accept-Ranges: bytes
# Content-Range: bytes 0-1023/...
```

## üîç –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ï—Å–ª–∏ certbot –Ω–µ –º–æ–∂–µ—Ç –ø–æ–ª—É—á–∏—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç:

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ DNS:**
   ```bash
   dig +short api.hotwell.synology.me
   # –î–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å: 159.255.37.158
   ```

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –ø–æ—Ä—Ç–∞ 80 —Å–Ω–∞—Ä—É–∂–∏:**
   ```bash
   # –° –≤–Ω–µ—à–Ω–µ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
   curl -I http://api.hotwell.synology.me/.well-known/acme-challenge/test
   ```

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ firewall:**
   ```bash
   ufw status
   # –î–æ–ª–∂–Ω—ã –±—ã—Ç—å –æ—Ç–∫—Ä—ã—Ç—ã –ø–æ—Ä—Ç—ã 80 –∏ 443
   ```

### –ï—Å–ª–∏ HTTPS –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞:

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
nginx -t

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
tail -50 /var/log/nginx/error.log

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ Nginx
systemctl restart nginx
```

## üìä –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ö–µ–º–∞

```
–ò–Ω—Ç–µ—Ä–Ω–µ—Ç (4G/–ª—é–±–æ–π)
    ‚Üì HTTPS (443)
VPS (159.255.37.158) - Nginx + Let's Encrypt
    ‚Üì HTTP (5000) —á–µ—Ä–µ–∑ VPN
Synology Backend (10.8.0.2:5000)
```

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç —Ñ–∏–Ω–∞–ª—å–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏

- [ ] DNS –Ω–∞—Å—Ç—Ä–æ–µ–Ω (api.hotwell.synology.me ‚Üí 159.255.37.158)
- [ ] Certbot —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- [ ] SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –ø–æ–ª—É—á–µ–Ω
- [ ] HTTPS —Ä–∞–±–æ—Ç–∞–µ—Ç (curl -I https://api.hotwell.synology.me/)
- [ ] –î–æ—Å—Ç—É–ø–µ–Ω —Å–Ω–∞—Ä—É–∂–∏ (–ø—Ä–æ–≤–µ—Ä–µ–Ω–æ —Å 4G)
- [ ] Range –∑–∞–ø—Ä–æ—Å—ã —Ä–∞–±–æ—Ç–∞—é—Ç (206 Partial Content)

## üìù –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–æ–≤
systemctl status nginx
systemctl status certbot.timer

# –õ–æ–≥–∏
tail -f /var/log/nginx/error.log
tail -f /var/log/nginx/access.log

# –ü—Ä–æ–≤–µ—Ä–∫–∞ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
certbot certificates

# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ –≤—Ä—É—á–Ω—É—é
certbot renew

# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ Nginx
systemctl reload nginx
```

## üéâ –ì–æ—Ç–æ–≤–æ!

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö —à–∞–≥–æ–≤ –≤–∞—à API –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É:
- **https://api.hotwell.synology.me/** - –æ—Å–Ω–æ–≤–Ω–æ–π endpoint
- **https://api.hotwell.synology.me/api/media/...** - –º–µ–¥–∏–∞ —Ñ–∞–π–ª—ã —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π Range

–í—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ VPN —Ç—É–Ω–Ω–µ–ª—å, –±–µ–∑ –æ—Ç–∫—Ä—ã—Ç–∏—è –ø–æ—Ä—Ç–æ–≤ –Ω–∞ –¥–æ–º–∞—à–Ω–µ–º —Ä–æ—É—Ç–µ—Ä–µ!




